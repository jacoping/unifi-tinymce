<!DOCTYPE html>
<html>

<head>
  <meta charset=“UTF-8”>
  <meta name="viewport" content="initial-scale=1.0,minimum-scale=1.0,maximum-scale=2.0,user-scalable=1">
  <title>UNIFI | Utility editor</title>


  <style media="screen">

  #container {
  }

  @media screen and (min-width: 768px) {
    #container {
      width: 960px;
      margin: auto;
    }
  }

    #destinazione {
      border: 1px solid red;
      box-sizing: border-box;
      margin-top: 30px;
      padding: 10px;
    }

  </style>


  <link rel="stylesheet" href="https://dipartimento.didacommunicationlab.it/dist/app.css?v=1578566027">

  <script src="./tinymce5/tinymce.min.js"></script>
  <script type="text/javascript">
    var update = function() {
      var contenuto = tinymce.activeEditor.getContent();
      document.querySelector("#destinazione").innerHTML = contenuto;
    }


      var settings = {
      init_instance_callback: function(editor) {
        update();

        // aggiorna il preview in tempo reale
        editor.on('Change', update);

        editor.on('Change', function(data){
          // wrappa tutti gli iframe con un div con classe iframe-container
          tinymce.activeEditor.dom.select('iframe').forEach(function(el){
            var realparent = el.parentNode.parentNode;
            if (realparent.tagName != 'DIV') {
              var container = document.createElement('div');
              container.classList.add("iframe-container");
              tinymce.activeEditor.dom.replace(container, realparent, true);
            }
          });
          // elimina tuttu i div che non contengono un iframe e li trasforma in p vuoti (con un br dentro) + pulisce i div
          tinymce.activeEditor.dom.select('div').forEach(function(el){
            if (el.classList.contains('iframe-container') && el.getElementsByTagName('SPAN').length > 0 && el.getElementsByTagName('SPAN')[0].classList.contains('mce-object-iframe') && el.getElementsByTagName('SPAN')[0].firstChild.tagName == 'IFRAME') {
              if (el.childNodes.length > 0) {
                // div is dirty: clean it
                el.childNodes.forEach(function(child){
                  if (child.tagName !== 'SPAN') {
                    el.removeChild(child);
                  }
                })
              }
            } else {
              // div is not an iframe container: delete it
              var emptyp = document.createElement('p');
              emptyp.innerHTML = '<br data-mce-bogus="1">';
              tinymce.activeEditor.dom.replace(emptyp, el, false);
            }
          })
        });
      },
      width: 960,
      height: 600,
      content_css: "https://dipartimento.didacommunicationlab.it/dist/app.css?v=1578566027",
      body_class: 'content-right',
      language: "it",
      schema: "html5",
      skin: "oxide-jacopo",
      entity_encoding: "raw",
      element_format: "html",

      // plugins attivi
      plugins: 'advlist anchor charmap code contextmenu hr image link lists media searchreplace table visualblocks visualchars wordcount fullscreen powerpaste template',

      // menu e toolbar
      menubar: false,
      toolbar1: 'bold italic underline strikethrough | superscript subscript | styleselect | charmap | removeformat | numlist bullist | hr | link unlink anchor | image media table template',
      toolbar2: 'undo redo | code | fullscreen',

      // toolbar mobile
      mobile: {
        theme: 'mobile'
      },


      // opzioni plugin
      powerpaste_allow_local_images: false,
      powerpaste_word_import: "clean",
      powerpaste_html_import: "clean",

      visualblocks_default_state: true,

      table_clone_elements: "a",
      table_appearance_options: false,
      table_advtab: false,
      table_cell_advtab: false,
      table_row_advtab: false,
      table_default_attributes: {},
      table_default_styles: {},
      table_responsive_width: true,
      table_resize_bars: false,
      table_style_by_css: true,

      link_class_list: [{
          title: "Nessuna",
          value: ""
        },
        {
          title: "Evidenza",
          value: "hilite"
        }
      ],
      link_title: true,

      image_dimensions: false,
      image_caption: false,
      image_advtab: false,

      media_dimensions: false,
      media_alt_source: false,
      media_poster: false,

      templates: [
        {
          title: 'Immagine con didascalia',
          description: 'This is my template.',
          content: '<figure class="with-caption"><img src="https://via.placeholder.com/2x1"><figcaption>Didascalia</figcaption></figure><p></p>'
        },
        {
          title: 'Miniature',
          description: 'This is my template.',
          content: '<figure class="miniature-container"><img src="https://via.placeholder.com/1"><figcaption><strong><u>Titolo</u></strong><br>Descrizione</figcaption></figure><p></p>'
        }
      ],

      formats: {
        underline: {inline: 'u'},
        strikethrough: {inline: 'del'},
      },

      style_formats: [
        {
          title: "Titolo principale (h2)",
          block: "h2"
        },
        {
          title: "Titolo secondario (h3)",
          block: "h3"
        },
        {
          title: "Titoletto (h4)",
          block: "h4"
        },
        {
          title: "Paragrafo",
          block: "p"
        },

        {
          title: "Blockquote",
          block: "blockquote"
        },
      ],

      keep_styles: false,

      // tag e attributi consentiti
      valid_elements: '@[id|style|src|alt|href|title|target],#p,-span,h2,h3,h4,blockquote,+a,-em,-strong,div[class],figure[class],img,figcaption,iframe[allowfullscreen],u,del,table,thead,tbody,tfoot,th,tr,td,col,colgroup,-ol,-ul,-li,-sub,-sup,br,hr',

      // stili in linea consentiti
      valid_styles: 'list-style-type',

      // questo non è assoluto, ma relativo allo schema (HTML5)
      valid_children : "+p[iframe],figure[img|figcaption],-figcaption[h2|h3|h4|figure],-h2[div,img,p,iframe],-h3[div,img,p,iframe],-h4[div,img,p,iframe],-p[img],-li[h2|h3|h4|p|blockquote],+div[iframe]"
    }

    var editor-contenuto = new tinymce.Editor('liveupdate-area',
        main-settings, tinymce.EditorManager);
    ed.render();

  </script>



</head>

<body>


  <div id="container">
    <header style="margin-top: 30px">
      <img src="./logo_unifi.svg" style="width: 150px; margin-left: 5px" >
      <h2 style="margin: 20px 0 0;">Utility per testing editor e stili pagine.</h2>
      <p style="font-weight: 300; font-size: 80%; margin-bottom: 30px"> L'editor presenta una raccolta completa degli stili disponibili e delle loro combiinazioni. È possibile usare l'editor per provare gli stili e le funzionalità. Il risultato apparirà in tempo reale nel rettangolo in basso con il bordo rosso. Per maggiori informazioni <strong> <a style="text-decoration: underline !important" id="moreinfo" href="#">cliccare qui</a> </strong>.</p>
    </header>

    <dialog id="moreinfo_dialog" class="content-right" style="width: 700px; padding: 100px 20px 20px;">
      <form method="dialog" class="content-right" >
      <button value="cancel" style="position: absolute; right: 30px">X</button>
      <h3> Informazioni sugli stili:</h3>
      <p>Usando la barra degli strumenti si possono inserire e modificare link, immagini, video e altri media, tabelle.</p>
      <p>Tramite il bottone "template" (simbolo del timbro) è possibile inserire due template per immagini con didascalia. Una volta inserito il template per modificare l'immagine usare l'apposito bottone nella barra degli strumenti.</p>

      <h3>Modifica diretta dell'HTML</h3>
      <p>È possibile modificare direttamente l'HTML cliccando su &lt; &gt;. <br>È ammesso l'utilizzo dei seguenti tag:</p>
      <ul>
        <li>h2, h3, h4, p, blockquote, hr</li>
        <li>a, em, strong, u, del, sub, sup, br, img</li>
        <li>ol, ul, li</li>
        <li>table (+ relativi)</li>
        <li>figure (img + figcaption)</li>
        <li>iframe</li>
      </ul>
      </ul>
      </form>
    </dialog>

    <script type="text/javascript">
      document.querySelector('#moreinfo').addEventListener('click', function(){
        document.getElementById('moreinfo_dialog').showModal();
      });
    </script>



  <textarea id="main-area" class="content-right">

    <h2>Questo è un h2.</h2>
    <h3>Questo è un h3.</h3>
    <h4>Questo è un h4.</h4>
    <p>Questo è un paragrafo. Questo è evidenziato rosso.</p>

    <p>Questo è un paragrafo un po' lungo. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla varius varius elit, ut lobortis velit cursus ut. Praesent quis libero dictum, <a href="https://www.unifi.it/" target="_blank" rel="noopener">questo è un link </a>tristique ipsum ut, lobortis mi. Suspendisse a mollis quam. Aenean eu erat vitae massa porttitor posuere. Suspendisse non tempus tortor. Interdum et malesuada fames ac ante ipsum primis <a href="https://www.google.com/" target="_blank" rel="noopener">questo è un link con icona </a>. Mauris lacinia libero in nibh gravida, vitae euismod ligula vulputate.</p>
    <p>E questo è un altro. Maecenas vitae felis elit. Vestibulum arcu orci, posuere non sodales sit amet, tincidunt quis ipsum. In nec elit leo. Curabitur eget leo ipsum. Pellentesque pretium nunc quis sapien volutpat pellentesque. Donec a nibh sapien. Fusce eget laoreet ligula, ut pulvinar leo.</p>

    <blockquote>Questo è un blockquote. Aenean eu erat vitae massa porttitor posuere. Suspendisse non tempus tortor. Interdum et malesuada fames ac ante ipsum primis in faucibus. Mauris lacinia libero in nibh gravida, vitae euismod ligula vulputate.</blockquote>

    <hr>

    <p><a href="https://www.unifi.it/" target="_blank" rel="noopener">Link normali</a></p>
    <p><a href="https://www.google.com/" target="_blank" rel="noopener">Link esterni</a></p>
    <p><a href="https://www.unifi.it/file.pdf" target="_blank" rel="noopener">Link esterni</a></p>
    <p><a href="https://www.google.com/file.pdf" target="_blank" rel="noopener">Link a file</a></p>

    <p><a class="hilite" href="https://www.unifi.it/" target="_blank" rel="noopener">Link in evidenza</a></p>

    <hr>

    <h3>Vari tipi di tabelle.</h3>

    <table>
    <thead>
    <tr>
    <td>col1</td>
    <td>col2</td>
    <td>col3</td>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>una</td>
    <td>tabella</td>
    <td>stretta</td>
    </tr>
    </tbody>
    </table>

    <table>
    <thead>
    <tr>
    <td>colonna uno</td>
    <td>colonna due</td>
    <td>colonna tre</td>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>una</td>
    <td>tabella</td>
    <td>normale</td>
    </tr>
    <tr>
    <td>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</td>
    <td>Phasellus interdum ante vel ligula molestie faucibus.</td>
    <td>Quisque eros libero, faucibus nec metus sit amet, ultricies finibus nibh. Donec ut odio nec turpis congue viverra nec sed eros. Etiam a ligula augue.</td>
    </tr>
    </tbody>
    </table>

    <table>
    <thead>
    <tr>
    <td>col1</td>
    <td>col2</td>
    <td>col3</td>
    <td>col4</td>
    <td>col5</td>
    <td>col6</td>
    <td>col7</td>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>unaTabellaMoltoLarga</td>
    <td>unaTabellaMoltoLarga</td>
    <td>unaTabellaMoltoLarga</td>
    <td>unaTabellaMoltoLarga</td>
    <td>unaTabellaMoltoLarga</td>
    <td>unaTabellaMoltoLarga</td>
    <td>unaTabellaMoltoLarga</td>
    </tr>
    </tbody>
    </table>

    <table>
    <thead>
    <tr>
    <td>colonna uno</td>
    <td>colonna due</td>
    <td>colonna tre</td>
    <td>colonna quattro</td>
    <td>colonna cinque</td>
    <td>colonna sei</td>
    <td>colonna sette</td>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>un'altra</td>
    <td>tabella</td>
    <td>molto</td>
    <td>molto</td>
    <td>molto</td>
    <td>molto</td>
    <td>larga</td>
    </tr>
    </tbody>
    </table>

    <hr>

    <h2>Immagini</h2>

    <h3>Esempi di gatti</h3>

    <p><img src="http://placekitten.com/g/500/300" alt="gatto"></p>
    <p>Questo era un gatto a tutta larghezza. E questo è un paragrafo. Maecenas vitae felis elit. Vestibulum arcu orci, posuere non sodales sit amet, tincidunt quis ipsum. In nec elit leo. Curabitur eget leo ipsum. Pellentesque pretium nunc quis sapien volutpat pellentesque. Donec a nibh sapien. Fusce eget laoreet ligula, ut pulvinar leo.</p>


    <figure class="with-caption"><img src="http://placekitten.com/g/500/250" alt="gatto">
    <figcaption>Questo è un gatto grande con didascalia.</figcaption>
    </figure>

    <hr>

    <h2>Miniature</h2>

    <figure class="miniature-container"><img src="https://i.pravatar.cc/300?img=1">
    <figcaption><strong><u>Titolo</u></strong><br>Descrizione</figcaption>
    </figure>

    <figure class="miniature-container"><img src="https://i.pravatar.cc/300?img=5">
    <figcaption><strong><u>Titolo</u></strong><br>Descrizione</figcaption>
    </figure>

    <figure class="miniature-container"><img src="https://i.pravatar.cc/300?img=7">
    <figcaption><strong><u>Titolo</u></strong><br>Descrizione</figcaption>
    </figure>

    <hr>
    <h3>Media embed</h3>
    <div class="iframe-container"><iframe src="https://www.youtube.com/embed/yKenAJfr818" allowfullscreen="allowfullscreen"></iframe></div>

    <hr>

    <h3>Elenchi ordinati:</h3>
    <ol>
    <li>primo</li>
    <li>secondo</li>
    <li>terzo</li>
    </ol>
    <ol style="list-style-type: lower-alpha;">
    <li>primo</li>
    <li>secondo</li>
    <li>terzo</li>
    </ol>
    <ol style="list-style-type: upper-alpha;">
    <li>primo</li>
    <li>secondo</li>
    <li>terzo</li>
    </ol>
    <h3>Elenchi disordinati:</h3>
    <ul>
    <li>pippo</li>
    <li>pluto</li>
    <li>topolino</li>
    </ul>
    <ul style="list-style-type: circle;">
    <li>pippo</li>
    <li>pluto</li>
    <li>topolino</li>
    </ul>
    <ul style="list-style-type: square;">
    <li>pippo</li>
    <li>pluto</li>
    <li>topolino</li>
    </ul>

    <h2>Questo è un h2 seguito da un p.</h2>
    <p>Questo è un paragrafo un po' lungo. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla varius varius elit, ut lobortis velit cursus ut. Praesent quis libero dictum, tristique ipsum ut, lobortis mi. Suspendisse a mollis quam. Aenean eu erat vitae massa porttitor posuere. Suspendisse non tempus tortor. Interdum et malesuada fames ac ante ipsum primis in faucibus. Mauris lacinia libero in nibh gravida, vitae euismod ligula vulputate.</p>
    <h3>Questo è un h3 seguito da un p.</h3>
    <p>E questo è un altro. Maecenas vitae felis elit. Vestibulum arcu orci, posuere non sodales sit amet, tincidunt quis ipsum. In nec elit leo. Curabitur eget leo ipsum. Pellentesque pretium nunc quis sapien volutpat pellentesque. Donec a nibh sapien. Fusce eget laoreet ligula, ut pulvinar leo.</p>

    <h4>Questo è un h4 seguito da un p.</h4>
    <p>Questo è un paragrafo un po' lungo. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla varius varius elit, ut lobortis velit cursus ut. Praesent quis libero dictum, tristique ipsum ut, lobortis mi. Suspendisse a mollis quam. Aenean eu erat vitae massa porttitor posuere. Suspendisse non tempus tortor. Interdum et malesuada fames ac ante ipsum primis in faucibus. Mauris lacinia libero in nibh gravida, vitae euismod ligula vulputate.</p>
    <h4>E un altro.</h4>
    <p>E questo è un altro. Maecenas vitae felis elit. Vestibulum arcu orci, posuere non sodales sit amet, tincidunt quis ipsum. In nec elit leo. Questo è evidenziato blu. Curabitur eget leo ipsum. Pellentesque pretium nunc quis sapien volutpat pellentesque. Donec a nibh sapien. Fusce eget laoreet ligula, ut pulvinar leo.</p>

    <h2>Questo è un h2 seguito da un h3 .</h2>
    <h3>Questo è un h3 seguito da un p.</h3>
    <p>E questo è un altro. Maecenas vitae felis elit. Vestibulum arcu orci, posuere non sodales sit amet, tincidunt quis ipsum. In nec elit leo. Curabitur eget leo ipsum. Pellentesque pretium nunc quis sapien volutpat pellentesque. Donec a nibh sapien. Fusce eget laoreet ligula, ut pulvinar leo.</p>

    <h3>Questo è un h3 seguito da un h4.</h3>
    <h4>Questo è un h4 seguito da un p.</h4>
    <p>E questo è un parafo. Maecenas vitae felis elit. Vestibulum arcu orci, posuere non sodales sit amet, tincidunt quis ipsum. In nec elit leo. Curabitur eget leo ipsum. Pellentesque pretium nunc quis sapien volutpat pellentesque. Donec a nibh sapien. Fusce eget laoreet ligula, ut pulvinar leo.</p>


  </textarea>
    <div id="destinazione" class="content-right">
    </div>
  </div>


</body>

</html>
